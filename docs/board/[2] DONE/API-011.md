# Template de Tarefa - Board do Projeto

> Este arquivo serve como **esqueleto obrigatorio** para qualquer tarefa dentro de `docs/board`.
> O agente **nao pode** criar tarefas fora deste formato.

---

## Identificacao
- **ID da tarefa:** API-011
- **Titulo curto:** Salario: confirmacao automatica por data
- **Status:** DONE
- **Responsavel (agente):** GPT-5 (Codex)
- **Reasoning effort:** High

---

## Contexto
As regras definem que transacoes de salario sao geradas como projetadas no inicio do mes e devem ser confirmadas automaticamente quando a data atual for maior ou igual a data de pagamento. Hoje existe apenas a geracao das projecoes, sem a confirmacao automatica.

---

## Escopo da Tarefa
### Inclui
- Implementar rotina para confirmar transacoes de salario (`source.type = salary`) com `status = projected` quando `date <= dataAtual`.
- Garantir que a rotina funcione no primeiro acesso apos a data (sem processo em background).
- Persistir a atualizacao no arquivo `transactions/YYYY-MM.json` apenas quando houver mudanca.

### Nao inclui (importante)
- Agendamento automatico em background.
- Alteracoes de UI ou endpoints HTTP.

---

## Regras de Negocio Relacionadas
- ideias.md: 7.1, 7.2, 7.3
- regras-de-negocio.md: 7.1, 7.2, 7.3, 7.4
- modelos-json.md: 4.6, 7

---

## Arquivos Impactados
- `server/data/salary-repository.js`
- `server/data/transactions-repository.js` (se for necessario reutilizar validacoes)

---

## Passos de Implementacao Esperados
1. Definir a assinatura da rotina de confirmacao (ex.: `confirmSalaryTransactionsForMonth(month, currentDate)`).
2. Carregar o arquivo mensal, filtrar transacoes de salario projetadas e atualizar o status quando `date <= currentDate`.
3. Persistir o arquivo apenas se houve mudanca e retornar um resumo da atualizacao.

> O agente pode ajustar os passos, mas **nao pode sair do escopo**.

---

## Criterios de Aceite
A tarefa so pode ser movida para **DONE** se **todos** forem verdadeiros:
- [ ] Regra de negocio respeitada
- [ ] Persistencia segue o modelo JSON
- [ ] Nao houve criacao de funcionalidade fora do escopo
- [ ] Fluxo minimo funcional validado manualmente

---

## Como Testar (Manual)
1. Gerar projecoes de salario para um mes (adiantamento e pagamento final).
2. Rodar a rotina com data anterior a uma das transacoes e validar que nada muda.
3. Rodar a rotina com data igual ou posterior e validar que o status vira `confirmed`.

---

## Pendencias / Observacoes
- Nenhuma.
