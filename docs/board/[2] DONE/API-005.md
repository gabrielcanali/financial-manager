# Template de Tarefa – Board do Projeto

> Este arquivo serve como **esqueleto obrigatório** para qualquer tarefa dentro de `docs/board`.
> O agente **não pode** criar tarefas fora deste formato.

---

## Identificação
- **ID da tarefa:** API-005
- **Título curto:** Parcelamento: criação e projeções
- **Status:** DONE
- **Responsável (agente):** GPT-5.1-Codex-Max
- **Reasoning effort:** High

---

## Contexto
Parcelamentos geram uma transação mãe e parcelas futuras projetadas. Apenas a primeira parcela é confirmada. A API deve criar essas transações respeitando o modelo JSON e a regra de fechamento para compras no cartão.

---

## Escopo da Tarefa
### Inclui
- Criar transação mãe com `installment.groupId`, `total` e `index`.
- Gerar parcelas futuras como transações projetadas.
- Respeitar o modo `direct` ou `creditCard` e aplicar a regra de fechamento quando for cartão.

### Não inclui (importante)
- Edição ou exclusão de parcelamentos existentes.
- Controle de limite de cartão.

---

## Regras de Negócio Relacionadas
- ideias.md: 4.2, 5.2
- regras-de-negocio.md: 4.1, 4.2, 6.3
- modelos-json.md: 4

---

## Arquivos Impactados
- `server/...`

---

## Passos de Implementação Esperados
1. Implementar lógica de criação da transação mãe e primeira parcela confirmada.
2. Gerar parcelas futuras com `status=projected` e `source.type=installment`.
3. Aplicar a regra de fechamento para definir o mês de cada parcela quando `mode=creditCard`.

> O agente pode ajustar os passos, mas **não pode sair do escopo**.

---

## Critérios de Aceite
A tarefa só pode ser movida para **DONE** se **todos** forem verdadeiros:
- [ ] Regra de negócio respeitada
- [ ] Persistência segue o modelo JSON
- [ ] Não houve criação de funcionalidade fora do escopo
- [ ] Fluxo mínimo funcional validado manualmente

---

## Como Testar (Manual)
1. Criar um parcelamento 3x com `mode=creditCard` e `closingDay` definido.
2. Validar que a primeira parcela está `confirmed` e as demais `projected`.
3. Confirmar que os meses das parcelas respeitam a regra do fechamento.

---

## Pendências / Observações
- Nenhuma.
