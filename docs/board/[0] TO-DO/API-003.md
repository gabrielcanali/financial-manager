# Template de Tarefa – Board do Projeto

> Este arquivo serve como **esqueleto obrigatório** para qualquer tarefa dentro de `docs/board`.
> O agente **não pode** criar tarefas fora deste formato.

---

## Identificação
- **ID da tarefa:** API-003
- **Título curto:** Cartão de crédito e regra de fechamento
- **Status:** TO-DO
- **Responsável (agente):** GPT-5.1-Codex-Max
- **Reasoning effort:** High

---

## Contexto
O cartão de crédito possui apenas o dia de fechamento e a regra de competência por fechamento. A API deve permitir configurar o `closingDay` e fornecer a lógica de cálculo do mês de fatura conforme as regras de negócio.

---

## Escopo da Tarefa
### Inclui
- Ler e atualizar `creditCard.json` com o campo `closingDay`.
- Validar `closingDay` no intervalo 1-31.
- Implementar a regra de competência por fechamento (antes do fechamento = mês atual; no dia = ciclo após fechamento).

### Não inclui (importante)
- Conceito de vencimento.
- Controle de limite de cartão.
- CRUD de faturas como entidade própria.

---

## Regras de Negócio Relacionadas
- ideias.md: 5.1, 5.2
- regras-de-negocio.md: 6.1, 6.2, 6.3
- modelos-json.md: 6

---

## Arquivos Impactados
- `server/...`

---

## Passos de Implementação Esperados
1. Implementar repositório de configuração do cartão usando JSON.
2. Implementar validações de `closingDay`.
3. Expor a função de cálculo de competência para uso em parcelamentos no cartão.

> O agente pode ajustar os passos, mas **não pode sair do escopo**.

---

## Critérios de Aceite
A tarefa só pode ser movida para **DONE** se **todos** forem verdadeiros:
- [ ] Regra de negócio respeitada
- [ ] Persistência segue o modelo JSON
- [ ] Não houve criação de funcionalidade fora do escopo
- [ ] Fluxo mínimo funcional validado manualmente

---

## Como Testar (Manual)
1. Definir `closingDay` como 20 em `creditCard.json`.
2. Calcular competência para uma compra em `YYYY-MM-19` e validar que permanece no mês atual.
3. Calcular competência para uma compra em `YYYY-MM-20` e validar que vai para o ciclo após o fechamento.

---

## Pendências / Observações
- Nenhuma.